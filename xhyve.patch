diff --git a/include/xhyve/xhyve.h b/include/xhyve/xhyve.h
index 4f85664..63a0c4c 100644
--- a/include/xhyve/xhyve.h
+++ b/include/xhyve/xhyve.h
@@ -78,3 +78,4 @@ void vcpu_add(int fromcpu, int newcpu, uint64_t rip);
 int fbsdrun_vmexit_on_hlt(void);
 int fbsdrun_vmexit_on_pause(void);
 int fbsdrun_virtio_msix(void);
+int run_xhyve(int argc, char *argv[]);
diff --git a/src/xhyve.c b/src/xhyve.c
index 97fd41f..5d21129 100644
--- a/src/xhyve.c
+++ b/src/xhyve.c
@@ -154,7 +154,7 @@ usage(int code)
 __attribute__ ((noreturn)) static void
 show_version()
 {
-        fprintf(stderr, "%s: %s\n\n%s\n",progname, VERSION,
+        fprintf(stderr, "%s: %s\n\n%s\n",progname, "VERSION",
 		"xhyve is a port of FreeBSD's bhyve hypervisor to OS X that\n"
 		"works entirely in userspace and has no other dependencies.\n\n"
 		"Homepage: https://github.com/mist64/xhyve\n"
@@ -774,7 +774,7 @@ fail:
 }
 
 int
-main(int argc, char *argv[])
+run_xhyve(int argc, char* argv[])
 {
 	int c, error, gdb_port, bvmcons, fw;
 	int dump_guest_memory, max_vcpus, mptgen;
@@ -947,5 +947,5 @@ main(int argc, char *argv[])
 	 */
 	mevent_dispatch();
 
-	exit(1);
+	return 0;
 }
